### Exercise 3

#### Meltdown-US-L1 (User-Supervisor, L1 Data Cache)

**Attack Scenarios:**

1. **User → Kernel space leak (same core)**
   - **Assumptions:** 
     - Attacker runs unprivileged user process
     - Victim data is in kernel space
     - Both on same logical core (hyperthreading not required)
   - **Goal:** Read kernel memory (secrets, crypto keys, passwords)

2. **Cross-hyperthread leak**
   - **Assumptions:**
     - Attacker and victim on same physical core, different logical cores (SMT/hyperthreading)
     - Victim's data is in L1d cache
   - **Goal:** Leak data from co-resident hyperthread

**Technique:** Speculatively access kernel memory, encode in L1d cache, use Flush+Reload to leak

---

#### Meltdown-US-LFB (User-Supervisor, Line Fill Buffer)

**Attack Scenarios:**

1. **User space → Kernel space leaks**
   - **Assumptions:**
     - Attacker is unprivileged user process
     - Executes system calls that cause kernel to access data
     - Attacker and kernel on same physical core (can be same or different logical cores)
   - **Goal:** Leak kernel data that was recently read/written

2. **Cross-hyperthread user space leak**
   - **Assumptions:**
     - Attacker and victim on same physical core, different logical cores (hyperthreading enabled)
     - Victim performs memory operations (read/write)
     - LFB is shared between hyperthreads
   - **Goal:** Leak random data read or written by victim process

3. **Covert channel between VMs**
   - **Assumptions:**
     - Sender VM and receiver VM on same physical core, different logical cores
     - Hypervisor schedules VMs on hyperthreads
   - **Goal:** Establish covert communication channel

4. **Attack on Trusted Execution Environment (TEE)**
   - **Assumptions:**
     - Attacker outside enclave (e.g., SGX)
     - Enclave executes on same physical core
     - Enclave data passes through LFB
   - **Goal:** Leak secrets from SGX enclave or TrustZone

**Technique:** LFB stores pending memory operations; speculatively access LFB entries to leak recent victim data

---

#### Meltdown-P-L1 (Physical Address, L1 Data Cache)

**Attack Scenarios:**

1. **Host attack (VM escape)**
   - **Assumptions:**
     - Attacker controls a VM
     - Can determine or guess physical addresses
     - Target data is in L1d cache (any physical address)
   - **Goal:** Read arbitrary physical memory (breach VM isolation)

2. **Cross-VM attack**
   - **Assumptions:**
     - Attacker VM and victim VM on same physical core
     - Attacker knows or can deduce victim's physical addresses
     - Victim's data is in L1d cache
   - **Goal:** Leak data from another VM (passwords, keys, secrets)

3. **Kernel ASLR/memory layout disclosure**
   - **Assumptions:**
     - Attacker is unprivileged user
     - Can speculatively access physical addresses
   - **Goal:** Determine physical memory layout, break KASLR

**Technique:** Speculatively access physical addresses directly (bypassing virtual memory protection), encode in L1d, leak via cache timing

---

#### Summary Table

| Variant | Bypasses | Shared Resource | Cross-Core? | Main Target |
|---------|----------|-----------------|-------------|-------------|
| **Meltdown-US-L1** | User/Supervisor bit | L1d cache | No (same core) | Kernel memory |
| **Meltdown-US-LFB** | User/Supervisor bit | Line Fill Buffer | Yes (hyperthreads) | Recent victim data |
| **Meltdown-P-L1** | Virtual memory | L1d cache | No (same core) | Arbitrary physical memory |

---

#### Key Differences

- **Meltdown-US-L1:** Classic Meltdown, reads kernel virtual addresses
- **Meltdown-US-LFB:** Leaks data from LFB (cross-hyperthread possible), doesn't need to know addresses
- **Meltdown-P-L1:** Accesses physical addresses directly, powerful for VM escape
